<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Buscador Avanzado de Libros</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
  background: linear-gradient(135deg, #1a1a1a 0%, #2d1b00 100%);
  color: #fff;
  min-height: 100vh;
  overflow-x: hidden;
  padding-bottom: 40px;
}

header {
  text-align: center;
  padding: 40px 20px;
  background: linear-gradient(to right, #8B4513 0%, #A0522D 100%);
  margin-bottom: 40px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  position: relative;
}

header::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(to right, #f1c40f, #e67e22);
}

header h1 {
  color: #f1c40f;
  font-size: 3rem;
  margin-bottom: 10px;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

header p {
  opacity: 0.9;
  margin-bottom: 15px;
  font-size: 1.1rem;
}

.advanced-search {
  max-width: 1200px;
  margin: 0 auto 40px;
  padding: 0 20px;
}

.search-container {
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
}

.search-input {
  flex: 1;
  padding: 15px 20px;
  border: none;
  border-radius: 30px;
  font-size: 16px;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  outline: none;
}

.search-input::placeholder {
  color: rgba(255, 255, 255, 0.7);
}

.search-btn {
  padding: 15px 25px;
  background: #f1c40f;
  color: #2c3e50;
  border: none;
  border-radius: 30px;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.3s;
  display: flex;
  align-items: center;
  gap: 8px;
}

.search-btn:hover {
  background: #f39c12;
}

.filters-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  background: rgba(255, 255, 255, 0.05);
  padding: 20px;
  border-radius: 15px;
}

.filter-group {
  margin-bottom: 15px;
}

.filter-group h3 {
  color: #f1c40f;
  margin-bottom: 10px;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 8px;
}

.filter-options {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.filter-option {
  background: rgba(255, 255, 255, 0.1);
  padding: 8px 15px;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.filter-option:hover {
  background: rgba(241, 196, 15, 0.2);
}

.filter-option.active {
  background: #f1c40f;
  color: #2c3e50;
  font-weight: bold;
}

.filter-select {
  width: 100%;
  padding: 10px 15px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.2);
  outline: none;
}

.filter-select option {
  background: #333;
}

.range-slider {
  width: 100%;
  margin: 10px 0;
}

.range-values {
  display: flex;
  justify-content: space-between;
  font-size: 0.9rem;
  color: #ccc;
}

.reset-filters {
  grid-column: 1 / -1;
  text-align: center;
  margin-top: 15px;
}

.reset-btn {
  background: transparent;
  color: #f1c40f;
  border: 1px solid #f1c40f;
  padding: 10px 20px;
  border-radius: 30px;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.reset-btn:hover {
  background: rgba(241, 196, 15, 0.1);
}

.genre-row {
  margin-bottom: 50px;
  padding: 0 20px;
}

.genre-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 0 10px 20px 10px;
  padding-bottom: 10px;
  border-bottom: 2px solid #f1c40f;
}

.genre-header h2 {
  font-size: 1.8rem;
  color: #f1c40f;
  display: flex;
  align-items: center;
  gap: 10px;
}

.ver-todo {
  color: #f1c40f;
  font-weight: bold;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: transform 0.3s;
}

.ver-todo:hover {
  text-decoration: underline;
  transform: translateX(5px);
}

.books-row {
  display: flex;
  overflow-x: auto;
  overflow-y: hidden;
  gap: 20px;
  padding: 15px;
  scroll-behavior: smooth;
  height: auto;
}

.books-row::-webkit-scrollbar {
  height: 8px;
}

.books-row::-webkit-scrollbar-thumb {
  background: #f1c40f;
  border-radius: 4px;
}

.books-row::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
}

.card {
  flex: 0 0 auto;
  width: 200px;
  height: 320px;
  border-radius: 12px;
  overflow: hidden;
  position: relative;
  cursor: pointer;
  transition: all 0.3s ease;
  display: block;
  text-decoration: none;
  color: inherit;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  position: relative;
  z-index: 1;
  transition: transform 0.5s;
}

.card-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
  padding: 20px 15px 15px;
  z-index: 2;
  transform: translateY(100%);
  transition: transform 0.3s ease;
}

.card-title {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 5px;
  color: #f1c40f;
}

.card-author {
  font-size: 14px;
  opacity: 0.9;
}

.card:hover {
  transform: translateY(-10px) scale(1.03);
  box-shadow: 0 12px 25px rgba(0, 0, 0, 0.5);
}

.card:hover img {
  transform: scale(1.1);
}

.card:hover .card-overlay {
  transform: translateY(0);
}

/* Modal Fullscreen Pro */
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.95);
  overflow-y: auto;
  justify-content: center;
  align-items: center;
  padding: 20px;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.modal.show {
  display: flex;
  opacity: 1;
}

.modal-content {
  display: flex;
  flex-direction: row;
  gap: 40px;
  max-width: 1200px;
  width: 100%;
  background: #1a1a1a;
  padding: 40px;
  border-radius: 15px;
  color: #fff;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  position: relative;
  transform: scale(0.9);
  transition: transform 0.3s ease;
}

.modal.show .modal-content {
  transform: scale(1);
}

.modal-left {
  flex: 0 0 300px;
}

.modal-left img {
  width: 100%;
  height: auto;
  object-fit: cover;
  border-radius: 8px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
}

.modal-right {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
}

.modal-right h2 {
  font-size: 2.2rem;
  color: #f1c40f;
  margin-bottom: 10px;
}

.modal-right h4 {
  font-size: 1.2rem;
  color: #e67e22;
  margin-bottom: 20px;
  font-weight: normal;
}

.modal-right p {
  line-height: 1.6;
  margin-bottom: 25px;
  font-size: 1.1rem;
}

.modal-details {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin-bottom: 25px;
}

.detail-item {
  display: flex;
  flex-direction: column;
}

.detail-label {
  font-weight: bold;
  color: #f1c40f;
  margin-bottom: 5px;
  font-size: 0.9rem;
}

.detail-value {
  font-size: 1rem;
}

.modal-buttons {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
  margin-top: 20px;
}

.modal-buttons a {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  background: #f1c40f;
  color: #2c3e50;
  text-decoration: none;
  border-radius: 30px;
  font-weight: bold;
  transition: all 0.3s;
}

.modal-buttons a:hover {
  background: #f39c12;
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.close {
  position: absolute;
  top: 20px;
  right: 30px;
  font-size: 35px;
  color: #f1c40f;
  font-weight: bold;
  cursor: pointer;
  z-index: 10;
  transition: transform 0.3s;
}

.close:hover {
  transform: rotate(90deg);
}

.video-container {
  margin: 25px 0;
  border-radius: 8px;
  overflow: hidden;
}

.video-container iframe {
  width: 100%;
  height: 250px;
  border: none;
  border-radius: 8px;
}

@media (max-width: 968px) {
  .modal-content {
    flex-direction: column;
    align-items: center;
    padding: 30px 20px;
    gap: 30px;
  }
  
  .modal-left {
    flex: 0 0 auto;
    width: 80%;
    max-width: 300px;
  }
  
  .modal-right {
    width: 100%;
  }
  
  .modal-details {
    grid-template-columns: 1fr;
  }
  
  .filters-container {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  header h1 {
    font-size: 2.2rem;
  }
  
  .search-container {
    flex-direction: column;
  }
  
  .card {
    width: 160px;
    height: 260px;
  }
  
  .modal-right h2 {
    font-size: 1.8rem;
  }
  
  .modal-buttons {
    justify-content: center;
  }
  
  .modal-buttons a {
    padding: 10px 15px;
    font-size: 0.9rem;
  }
}

.genre-icon {
  font-size: 24px;
}

.loading {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100px;
}

.loading::after {
  content: "";
  width: 40px;
  height: 40px;
  border: 4px solid transparent;
  border-top: 4px solid #f1c40f;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.rating {
  display: flex;
  gap: 3px;
  margin: 10px 0;
}

.rating i {
  color: #f1c40f;
  font-size: 16px;
}

.results-info {
  text-align: center;
  margin: 20px 0;
  font-size: 1.2rem;
  color: #f1c40f;
}

.filter-toggle {
  display: none;
  background: #f1c40f;
  color: #2c3e50;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  margin: 0 auto 20px;
  cursor: pointer;
  font-weight: bold;
}

@media (max-width: 968px) {
  .filter-toggle {
    display: block;
  }
  
  .filters-container {
    display: none;
  }
  
  .filters-container.show {
    display: grid;
  }
}
</style>
</head>
<body>

<header>
  <h1><i class="fas fa-book-reader"></i> Buscador Avanzado de Libros</h1>
  <p>Encuentra tu próxima lectura con nuestros filtros avanzados</p>
</header>

<div class="advanced-search">
  <div class="search-container">
    <input type="text" class="search-input" id="searchInput" placeholder="Buscar por título, autor, descripción...">
    <button class="search-btn" id="searchBtn"><i class="fas fa-search"></i> Buscar</button>
  </div>
  
  <button class="filter-toggle" id="filterToggle"><i class="fas fa-filter"></i> Mostrar Filtros</button>
  
  <div class="filters-container" id="filtersContainer">
    <div class="filter-group">
      <h3><i class="fas fa-feather-alt"></i> Géneros</h3>
      <div class="filter-options" id="genreFilters">
        <!-- Los géneros se cargarán con JavaScript -->
      </div>
    </div>
    
    <div class="filter-group">
      <h3><i class="fas fa-user-edit"></i> Autores</h3>
      <select class="filter-select" id="authorFilter">
        <option value="all">Todos los autores</option>
        <!-- Los autores se cargarán con JavaScript -->
      </select>
    </div>
    
    <div class="filter-group">
      <h3><i class="fas fa-building"></i> Editoriales</h3>
      <select class="filter-select" id="publisherFilter">
        <option value="all">Todas las editoriales</option>
        <!-- Las editoriales se cargarán con JavaScript -->
      </select>
    </div>
    
    <div class="filter-group">
      <h3><i class="fas fa-star"></i> Calificación</h3>
      <select class="filter-select" id="ratingFilter">
        <option value="all">Cualquier calificación</option>
        <option value="4.5">4.5 estrellas o más</option>
        <option value="4">4 estrellas o más</option>
        <option value="3.5">3.5 estrellas o más</option>
        <option value="3">3 estrellas o más</option>
      </select>
    </div>
    
    <div class="filter-group">
      <h3><i class="fas fa-calendar-alt"></i> Año de publicación</h3>
      <select class="filter-select" id="yearFilter">
        <option value="all">Todos los años</option>
        <option value="2020">2020 - Actualidad</option>
        <option value="2010">2010 - 2019</option>
        <option value="2000">2000 - 2009</option>
        <option value="1990">1990 - 1999</option>
        <option value="1980">1980 - 1989</option>
        <option value="1970">1970 - 1979</option>
        <option value="1960">1960 - 1969</option>
        <option value="1950">1950 - 1959</option>
        <option value="1900">Antes de 1950</option>
      </select>
    </div>
    
    <div class="filter-group">
      <h3><i class="fas fa-sort-amount-down"></i> Ordenar por</h3>
      <select class="filter-select" id="sortFilter">
        <option value="title">Título (A-Z)</option>
        <option value="title-desc">Título (Z-A)</option>
        <option value="author">Autor (A-Z)</option>
        <option value="year">Año (Más reciente)</option>
        <option value="year-old">Año (Más antiguo)</option>
        <option value="rating">Mejor valorados</option>
      </select>
    </div>
    
    <div class="reset-filters">
      <button class="reset-btn" id="resetFilters"><i class="fas fa-redo"></i> Restablecer filtros</button>
    </div>
  </div>
</div>

<div id="library"></div>

<div class="results-info" id="resultsInfo"></div>

<!-- Modal Fullscreen -->
<div id="bookModal" class="modal">
  <span class="close">&times;</span>
  <div class="modal-content">
    <div class="modal-left">
      <img id="modal-cover" src="" alt="Portada libro">
    </div>
    <div class="modal-right">
      <h2 id="modal-title">Título del libro</h2>
      <h4 id="modal-subtitle">Subtítulo / Autor</h4>
      
      <div class="rating" id="modal-rating">
        <!-- Rating stars will be inserted here -->
      </div>
      
      <p id="modal-description">Descripción completa y profesional del libro. Contenido de ejemplo para ver cómo se verá la modal. Aquí se puede añadir información extensa sobre trama, personajes, contexto histórico, crítica literaria, etc.</p>
      
      <div class="modal-details">
        <div class="detail-item">
          <span class="detail-label">Páginas</span>
          <span class="detail-value" id="modal-pages">320</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">ISBN</span>
          <span class="detail-value" id="modal-isbn">123-4567890123</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Idioma</span>
          <span class="detail-value" id="modal-language">Español</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Editorial</span>
          <span class="detail-value" id="modal-publisher">Ejemplo Editorial</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Año</span>
          <span class="detail-value" id="modal-year">2023</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Género</span>
          <span class="detail-value" id="modal-genre">Novela</span>
        </div>
      </div>
      
      <div class="video-container">
        <iframe id="modal-video" src="" frameborder="0" allowfullscreen></iframe>
      </div>
      
      <div class="modal-buttons">
        <a href="#" target="_blank"><i class="fas fa-shopping-cart"></i> Comprar</a>
        <a href="#" target="_blank"><i class="fab fa-amazon"></i> Amazon</a>
        <a href="#" target="_blank"><i class="fas fa-share-alt"></i> Compartir</a>
        <a href="#" target="_blank"><i class="fas fa-book-open"></i> Leer muestra</a>
      </div>
    </div>
  </div>
</div>

<script>
// Datos de libros mejorados con portadas reales
const libros = [
  {
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "1984",
    autor: "George Orwell",
    subtitulo: "Una visión distópica del futuro",
    genero: "Distopía",
    portada: "https://images.pexels.com/photos/1370298/pexels-photo-1370298.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela introduce el concepto del 'Gran Hermano', un líder omnipresente que vigila a todos los ciudadanos. Winston Smith, el protagonista, trabaja reescribiendo la historia para adaptarla a la versión del Partido. Una crítica feroz a los totalitarismos y una reflexión sobre la manipulación de la información.",
    paginas: 328,
    isbn: "978-0451524935",
    idioma: "Español",
    editorial: "Debolsillo",
    año: 1949,
    rating: 4.7,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "El Señor de los Anillos",
    autor: "J.R.R. Tolkien",
    subtitulo: "La comunidad del anillo",
    genero: "Fantasía Épica",
    portada: "https://images.pexels.com/photos/459791/pexels-photo-459791.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "En la Tierra Media, el Señor Oscuro Sauron forjó los Grandes Anillos del Poder. Tres para los elfos, siete para los enanos, y nueve para los hombres. Pero secretamente, Sauron también forjó un anillo maestro, el Único Anillo, que contendría el poder para esclavizar a toda la Tierra Media.",
    paginas: 576,
    isbn: "978-8445000660",
    idioma: "Español",
    editorial: "Minotauro",
    año: 1954,
    rating: 4.9,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "Harry Potter y la piedra filosofal",
    autor: "J.K. Rowling",
    subtitulo: "El comienzo de la magia",
    genero: "Fantasía",
    portada: "https://images.pexels.com/photos/1005460/pexels-photo-1005460.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "Harry Potter se ha quedado huérfano y vive en casa de sus abominables tíos y del insoportable primo Dudley. Harry se siente muy triste y solo, hasta que un buen día recibe una carta que cambiará su vida para siempre. En ella le comunican que ha sido aceptado como alumno en el colegio interno Hogwarts de magia y hechicería.",
    paginas: 309,
    isbn: "978-8478884456",
    idioma: "Español",
    editorial: "Salamandra",
    año: 1997,
    rating: 4.9,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "Don Quijote de la Mancha",
    autor: "Miguel de Cervantes",
    subtitulo: "El caballero de la triste figura",
    genero: "Clásico",
    portada: "https://images.pexels.com/photos/674268/pexels-photo-674268.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La obra cuenta las aventuras de Alonso Quijano, un hidalgo manchego que, tras leer demasiados libros de caballerías, enloquece y decide convertirse en caballero andante con el nombre de Don Quijote de la Mancha. Montado en su caballo Rocinante y acompañado por su fiel escudero Sancho Panza, recorre España en busca de aventuras.",
    paginas: 1072,
    isbn: "978-8424116969",
    idioma: "Español",
    editorial: "Real Academia Española",
    año: 1605,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "Orgullo y prejuicio",
    autor: "Jane Austen",
    subtitulo: "Una comedia romántica clásica",
    genero: "Romance",
    portada: "https://images.pexels.com/photos/1370295/pexels-photo-1370295.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La señora Bennet ha criado a sus cinco hijas con el único deseo de encontrar marido. La llegada de Charles Bingley, un joven rico y soltero, alaba las esperanzas de la familia. Elizabeth Bennet, inteligente y con fuerte carácter, se enfrentará al arrogante señor Darcy, desencadenando una de las historias de amor más famosas de la literatura.",
    paginas: 432,
    isbn: "978-0141439518",
    idioma: "Español",
    editorial: "Penguin Clásicos",
    año: 1813,
    rating: 4.6,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "Crónica de una muerte anunciada",
    autor: "Gabriel García Márquez",
    subtitulo: "Novela corta de suspense",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1272853/pexels-photo-1272853.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela reconstruye la historia del asesinato de Santiago Nasar, un joven de 21 años, a manos de los hermanos Vicario. La trama se desarrolla en un pequeño pueblo caribeño, donde todos los habitantes conocen la intención de los hermanos de matar a Santiago, pero nadie hace lo suficiente para evitarlo.",
    paginas: 120,
    isbn: "978-8439721103",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1981,
    rating: 4.5,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "Fahrenheit 451",
    autor: "Ray Bradbury",
    subtitulo: "Una distopía sobre la censura",
    genero: "Distopía",
    portada: "https://images.pexels.com/photos/2908984/pexels-photo-2908984.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela presenta una sociedad futura donde los libros están prohibidos y los 'bomberos' queman cualquier libro que encuentren. El protagonista, Guy Montag, es uno de estos bomberos que, tras conocer a una joven vecina que le hace cuestionarse su mundo, comienza a esconder libros y a leerlos en secreto.",
    paginas: 256,
    isbn: "978-0451524936",
    idioma: "Español",
    editorial: "Debolsillo",
    año: 1953,
    rating: 4.4,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  }
];

// Añadir más libros para cada categoría
const categorias = ["Realismo Mágico", "Distopía", "Fantasía Épica", "Fantasía", "Clásico", "Romance"];
const iconosCategorias = {
  "Realismo Mágico": "fas fa-magic",
  "Distopía": "fas fa-city",
  "Fantasía Épica": "fas fa-dragon",
  "Fantasía": "fas fa-hat-wizard",
  "Clásico": "fas fa-monument",
  "Romance": "fas fa-heart"
};

// Añadir más libros a cada categoría
categorias.forEach(cat => {
  for (let i = 2; i <= 6; i++) {
    const libroBase = libros.find(l => l.genero === cat);
    if (libroBase) {
      libros.push({
        ...libroBase,
        titulo: `${cat} Libro ${i}`,
        autor: `Autor ${i}`,
        portada: `https://images.pexels.com/photos/${1272853 + i}/pexels-photo-${1272853 + i}.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1`,
        rating: (4 + Math.random()).toFixed(1),
        año: Math.floor(Math.random() * 50) + 1970
      });
    }
  }
});

// Variables globales
const libraryContainer = document.getElementById('library');
const searchInput = document.getElementById('searchInput');
const searchBtn = document.getElementById('searchBtn');
const genreFilters = document.getElementById('genreFilters');
const authorFilter = document.getElementById('authorFilter');
const publisherFilter = document.getElementById('publisherFilter');
const ratingFilter = document.getElementById('ratingFilter');
const yearFilter = document.getElementById('yearFilter');
const sortFilter = document.getElementById('sortFilter');
const resetFilters = document.getElementById('resetFilters');
const resultsInfo = document.getElementById('resultsInfo');
const filterToggle = document.getElementById('filterToggle');
const filtersContainer = document.getElementById('filtersContainer');

// Inicializar filtros
function initFilters() {
  // Cargar géneros
  const generos = [...new Set(libros.map(libro => libro.genero))];
  generos.forEach(genero => {
    const option = document.createElement('div');
    option.className = 'filter-option';
    option.dataset.value = genero;
    option.textContent = genero;
    genreFilters.appendChild(option);
  });
  
  // Cargar autores
  const autores = [...new Set(libros.map(libro => libro.autor))];
  autores.forEach(autor => {
    const option = document.createElement('option');
    option.value = autor;
    option.textContent = autor;
    authorFilter.appendChild(option);
  });
  
  // Cargar editoriales
  const editoriales = [...new Set(libros.map(libro => libro.editorial))];
  editoriales.forEach(editorial => {
    const option = document.createElement('option');
    option.value = editorial;
    option.textContent = editorial;
    publisherFilter.appendChild(option);
  });
  
  // Event listeners para los filtros
  document.querySelectorAll('.filter-option').forEach(option => {
    option.addEventListener('click', () => {
      option.classList.toggle('active');
      filterBooks();
    });
  });
  
  authorFilter.addEventListener('change', filterBooks);
  publisherFilter.addEventListener('change', filterBooks);
  ratingFilter.addEventListener('change', filterBooks);
  yearFilter.addEventListener('change', filterBooks);
  sortFilter.addEventListener('change', filterBooks);
  resetFilters.addEventListener('click', resetAllFilters);
  filterToggle.addEventListener('click', () => {
    filtersContainer.classList.toggle('show');
  });
}

// Filtrar libros según los criterios seleccionados
function filterBooks() {
  const searchTerm = searchInput.value.toLowerCase();
  const selectedGenres = [...document.querySelectorAll('.filter-option.active')].map(el => el.dataset.value);
  const selectedAuthor = authorFilter.value;
  const selectedPublisher = publisherFilter.value;
  const selectedRating = parseFloat(ratingFilter.value);
  const selectedYear = yearFilter.value;
  const sortBy = sortFilter.value;
  
  let filtered = libros.filter(libro => {
    // Filtro de búsqueda de texto
    const matchesSearch = searchTerm === '' || 
      libro.titulo.toLowerCase().includes(searchTerm) ||
      libro.autor.toLowerCase().includes(searchTerm) ||
      libro.descripcion.toLowerCase().includes(searchTerm);
    
    // Filtro de géneros
    const matchesGenre = selectedGenres.length === 0 || selectedGenres.includes(libro.genero);
    
    // Filtro de autor
    const matchesAuthor = selectedAuthor === 'all' || libro.autor === selectedAuthor;
    
    // Filtro de editorial
    const matchesPublisher = selectedPublisher === 'all' || libro.editorial === selectedPublisher;
    
    // Filtro de rating
    const matchesRating = isNaN(selectedRating) || libro.rating >= selectedRating;
    
    // Filtro de año
    let matchesYear = true;
    if (selectedYear !== 'all') {
      const year = parseInt(selectedYear);
      if (year >= 2020) {
        matchesYear = libro.año >= 2020;
      } else if (year >= 2010) {
        matchesYear = libro.año >= 2010 && libro.año <= 2019;
      } else if (year >= 2000) {
        matchesYear = libro.año >= 2000 && libro.año <= 2009;
      } else if (year >= 1990) {
        matchesYear = libro.año >= 1990 && libro.año <= 1999;
      } else if (year >= 1980) {
        matchesYear = libro.año >= 1980 && libro.año <= 1989;
      } else if (year >= 1970) {
        matchesYear = libro.año >= 1970 && libro.año <= 1979;
      } else if (year >= 1960) {
        matchesYear = libro.año >= 1960 && libro.año <= 1969;
      } else if (year >= 1950) {
        matchesYear = libro.año >= 1950 && libro.año <= 1959;
      } else if (year === '1900') {
        matchesYear = libro.año < 1950;
      }
    }
    
    return matchesSearch && matchesGenre && matchesAuthor && matchesPublisher && matchesRating && matchesYear;
  });
  
  // Ordenar resultados
  switch(sortBy) {
    case 'title':
      filtered.sort((a, b) => a.titulo.localeCompare(b.titulo));
      break;
    case 'title-desc':
      filtered.sort((a, b) => b.titulo.localeCompare(a.titulo));
      break;
    case 'author':
      filtered.sort((a, b) => a.autor.localeCompare(b.autor));
      break;
    case 'year':
      filtered.sort((a, b) => b.año - a.año);
      break;
    case 'year-old':
      filtered.sort((a, b) => a.año - b.año);
      break;
    case 'rating':
      filtered.sort((a, b) => b.rating - a.rating);
      break;
  }
  
  // Mostrar información de resultados
  resultsInfo.textContent = `Se encontraron ${filtered.length} libro${filtered.length !== 1 ? 's' : ''}`;
  
  // Renderizar resultados
  renderLibrary(filtered);
}

// Restablecer todos los filtros
function resetAllFilters() {
  searchInput.value = '';
  document.querySelectorAll('.filter-option.active').forEach(option => {
    option.classList.remove('active');
  });
  authorFilter.value = 'all';
  publisherFilter.value = 'all';
  ratingFilter.value = 'all';
  yearFilter.value = 'all';
  sortFilter.value = 'title';
  filterBooks();
}

// Renderizar carruseles
function renderLibrary(librosToRender = libros) {
  libraryContainer.innerHTML = '';
  
  // Agrupar libros por género
  const librosPorGenero = {};
  librosToRender.forEach(libro => {
    if (!librosPorGenero[libro.genero]) {
      librosPorGenero[libro.genero] = [];
    }
    librosPorGenero[libro.genero].push(libro);
  });
  
  // Crear secciones para cada género
  Object.keys(librosPorGenero).forEach(cat => {
    const rowDiv = document.createElement('div');
    rowDiv.className = 'genre-row';
    
    const headerDiv = document.createElement('div');
    headerDiv.className = 'genre-header';
    
    const title = document.createElement('h2');
    title.innerHTML = `<i class="${iconosCategorias[cat] || 'fas fa-book'} genre-icon"></i> ${cat}`;
    
    const verTodo = document.createElement('a');
    verTodo.href = "#";
    verTodo.className = "ver-todo";
    verTodo.innerHTML = "Ver todo <i class='fas fa-arrow-right'></i>";
    
    headerDiv.appendChild(title);
    headerDiv.appendChild(verTodo);
    rowDiv.appendChild(headerDiv);
    
    const booksRow = document.createElement('div');
    booksRow.className = 'books-row';
    
    librosPorGenero[cat].forEach(libro => {
      const cardLink = document.createElement('a');
      cardLink.href = "#";
      cardLink.className = "card";
      cardLink.innerHTML = `
        <img src="${libro.portada}" alt="${libro.titulo}">
        <div class="card-overlay">
          <div class="card-title">${libro.titulo}</div>
          <div class="card-author">${libro.autor}</div>
        </div>
      `;
      
      cardLink.addEventListener('click', e => {
        e.preventDefault();
        openBookModal(libro);
      });
      
      booksRow.appendChild(cardLink);
    });
    
    rowDiv.appendChild(booksRow);
    libraryContainer.appendChild(rowDiv);
  });
  
  // Si no hay resultados, mostrar mensaje
  if (librosToRender.length === 0) {
    libraryContainer.innerHTML = `
      <div class="no-results">
        <i class="fas fa-book" style="font-size: 50px; color: #f1c40f; margin-bottom: 20px;"></i>
        <h2>No se encontraron libros</h2>
        <p>Intenta ajustar los filtros de búsqueda</p>
      </div>
    `;
  }
}

// Modal
const modal = document.getElementById('bookModal');
const modalCover = document.getElementById('modal-cover');
const modalTitle = document.getElementById('modal-title');
const modalSubtitle = document.getElementById('modal-subtitle');
const modalDescription = document.getElementById('modal-description');
const modalPages = document.getElementById('modal-pages');
const modalIsbn = document.getElementById('modal-isbn');
const modalLanguage = document.getElementById('modal-language');
const modalPublisher = document.getElementById('modal-publisher');
const modalYear = document.getElementById('modal-year');
const modalGenre = document.getElementById('modal-genre');
const modalVideo = document.getElementById('modal-video');
const modalRating = document.getElementById('modal-rating');
const closeModal = document.querySelector('.close');

function openBookModal(libro) {
  modal.classList.add('show');
  modalCover.src = libro.portada;
  modalTitle.innerText = libro.titulo;
  modalSubtitle.innerText = `${libro.subtitulo} - ${libro.autor}`;
  modalDescription.innerText = libro.descripcion;
  modalPages.innerText = libro.paginas;
  modalIsbn.innerText = libro.isbn;
  modalLanguage.innerText = libro.idioma;
  modalPublisher.innerText = libro.editorial;
  modalYear.innerText = libro.año;
  modalGenre.innerText = libro.genero;
  modalVideo.src = libro.video;
  
  // Actualizar rating
  modalRating.innerHTML = '';
  const fullStars = Math.floor(libro.rating);
  const hasHalfStar = libro.rating % 1 >= 0.5;
  
  for (let i = 0; i < fullStars; i++) {
    modalRating.innerHTML += '<i class="fas fa-star"></i>';
  }
  
  if (hasHalfStar) {
    modalRating.innerHTML += '<i class="fas fa-star-half-alt"></i>';
  }
  
  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
  for (let i = 0; i < emptyStars; i++) {
    modalRating.innerHTML += '<i class="far fa-star"></i>';
  }
  
  modalRating.innerHTML += `<span style="margin-left: 10px;">${libro.rating}/5</span>`;
}

closeModal.onclick = () => {
  modal.classList.remove('show');
  modalVideo.src = ''; // Pausar video al cerrar modal
}

window.onclick = e => {
  if (e.target == modal) {
    modal.classList.remove('show');
    modalVideo.src = ''; // Pausar video al cerrar modal
  }
}

// Funcionalidad de búsqueda
searchBtn.addEventListener('click', filterBooks);
searchInput.addEventListener('keyup', e => {
  if (e.key === 'Enter') {
    filterBooks();
  }
});

// Inicializar la biblioteca
initFilters();
renderLibrary();
</script>
</body>
</html>
