<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Biblioteca Literaria - Autor</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css  ">
<style>
/* === RESET / BASE === */
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body {
  background: #0a1a2e;
  color: #fff;
  min-height: 100vh;
  overflow-x: hidden;
  padding-bottom: 40px;
}

/* === LOADING INDICATOR === */
.loading {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #061120;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  transition: opacity 0.5s ease-out;
}

.loading.hidden {
  opacity: 0;
  pointer-events: none;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 5px solid rgba(241, 196, 15, 0.2);
  border-radius: 50%;
  border-top-color: #f1c40f;
  animation: spin 1s linear infinite;
  margin-bottom: 20px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-text {
  color: #f1c40f;
  font-size: 1.2rem;
}

/* === HEADER / SLIDER === */
.header-container { position: relative; margin-bottom: 40px; }
.top-menu {
  display:flex; justify-content:space-between; align-items:center;
  padding:15px 20px;
  background: #0a1a2e;
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  position: relative;
  z-index: 10;
}
.logo { display:flex; align-items:center; gap:10px; }
.logo h1 { color:#f1c40f; font-size:1.5rem; text-shadow:2px 2px 4px rgba(0,0,0,0.5); }
.menu-icons { display:flex; gap:15px; }
.menu-icon { color:#f1c40f; font-size:1.3rem; cursor:pointer; transition: transform .3s, color .3s; }
.menu-icon:hover { color:#fff; transform: translateY(-3px); }

.slider-container { 
  position:relative; 
  width:100%; 
  height:300px; 
  overflow:hidden; 
  background: #061120;
}
.slide { 
  position:absolute; 
  width:100%; 
  height:100%; 
  opacity:0; 
  transition:opacity 1.2s ease-in-out; 
  z-index:1; 
  background: #1a2b4a;
}
.slide.active { opacity:1; z-index:2; }
.slide img { 
  width:100%; 
  height:100%; 
  object-fit:cover; 
  display:block;
}
.slide-overlay {
  position:absolute; bottom:0; left:0; right:0;
  background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
  padding:20px; color:#fff;
}
.slide-title { font-size:1.5rem; color:#f1c40f; margin-bottom:8px; }
.slide-description { font-size:0.9rem; max-width:600px; }

.slider-nav { position:absolute; bottom:15px; left:50%; transform:translateX(-50%); display:flex; gap:8px; z-index:3; }
.slider-dot { width:10px; height:10px; border-radius:50%; background:rgba(255,255,255,0.5); cursor:pointer; transition: transform .2s, background .2s; }
.slider-dot.active { background:#f1c40f; transform:scale(1.2); }

/* === SECCIÓN AUTOR === */
.author-section {
  padding: 40px 20px;
  background: linear-gradient(to right, #0a1a2e, #061120);
  margin: 0 auto 40px;
  max-width: 1200px;
  border-radius: 12px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.author-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 25px;
}

.author-image {
  width: 180px;
  height: 180px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid #f1c40f;
  box-shadow: 0 0 20px rgba(241, 196, 15, 0.3);
}

.author-info {
  text-align: center;
  max-width: 800px;
}

.author-name {
  font-size: 2.2rem;
  color: #f1c40f;
  margin-bottom: 15px;
  position: relative;
  display: inline-block;
}

.author-name:after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 3px;
  background: #f1c40f;
}

.author-bio {
  font-size: 1.1rem;
  line-height: 1.7;
  color: #e0e0e0;
  margin-bottom: 20px;
}

.author-details {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  margin-top: 20px;
}

.author-detail {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: rgba(26, 43, 74, 0.7);
  padding: 15px;
  border-radius: 8px;
  min-width: 150px;
}

.detail-value {
  font-size: 1.5rem;
  font-weight: bold;
  color: #f1c40f;
  margin-bottom: 5px;
}

.detail-label {
  font-size: 0.9rem;
  color: #a0a0a0;
}

/* === LIBROS / GRID === */
.genre-row { margin-bottom:40px; padding:0 15px; }
.genre-header {
  display:flex; justify-content:space-between; align-items:center;
  margin:0 10px 15px 10px; padding-bottom:8px; border-bottom:2px solid #f1c40f;
}
.genre-header h2 { font-size:1.5rem; color:#f1c40f; display:flex; align-items:center; gap:10px; }
.ver-todo { color:#f1c40f; font-weight:bold; text-decoration:none; display:flex; align-items:center; gap:5px; transition:transform .3s; font-size: 0.9rem; }
.ver-todo:hover { transform: translateX(5px); text-decoration:underline; }

.books-grid {
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:15px;
  padding:10px;
  max-width: 1200px;
  margin: 0 auto;
}

.card {
  width:100%; 
  border-radius:8px; 
  overflow:hidden; 
  position:relative;
  cursor:pointer; 
  transition: all .3s ease; 
  display:block; 
  text-decoration:none; 
  color:inherit;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  background: #1a2b4a;
  aspect-ratio: 2/3;
}
.card img { 
  width:100%; 
  height: 100%; 
  object-fit:cover; 
  display:block; 
  transition: transform .5s;
}
.card-overlay {
  position:absolute; bottom:0; left:0; right:0;
  background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
  padding:12px; z-index:2; transform: translateY(100%); transition: transform .3s ease;
}
.card-title { font-size:14px; font-weight:bold; margin-bottom:4px; color:#f1c40f; }
.card-author { font-size:12px; opacity:0.9; }
.card:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.5); }
.card:hover img { transform: scale(1.05); }
.card:hover .card-overlay { transform: translateY(0); }

/* === MODAL === */
.modal { 
  display:none; 
  position:fixed; 
  inset:0; 
  z-index:1000; 
  background-color: rgba(0,0,0,0.95); 
  overflow-y: auto; 
  -webkit-overflow-scrolling: touch; 
  padding: 15px; 
}
.modal::-webkit-scrollbar { display:none; }
.modal.show { display:block; }
.modal-container { 
  width: 100%; 
  max-width: 1000px; 
  margin: 0 auto; 
  background: #0a1a2e; 
  color:#fff; 
  border-radius:8px; 
  display:flex; 
  flex-direction:column; 
  box-shadow: 0 10px 30px rgba(0,0,0,0.6); 
  overflow: hidden;
}
.modal-header { 
  padding:15px 20px; 
  background:#061120; 
  display:flex; 
  justify-content:space-between; 
  align-items:center; 
  border-bottom:1px solid #1a2b4a; 
}
.modal-title { 
  font-size:1.5rem; 
  color:#f1c40f; 
  max-width:80%; 
  word-wrap:break-word; 
}
.close { 
  font-size:24px; 
  color:#f1c40f; 
  font-weight:bold; 
  cursor:pointer; 
  background:none; 
  border:none; 
  transition: transform .25s; 
}
.close:hover { transform: rotate(90deg); }
.modal-content { 
  display:flex; 
  flex-direction:column; 
  align-items:flex-start; 
  gap:0; 
}
.modal-left { 
  width:100%; 
  padding:20px; 
  display:flex; 
  flex-direction:column; 
  align-items:center; 
  background:#061120; 
  border-bottom:1px solid #1a2b4a; 
}
.modal-left img { 
  width:100%; 
  max-width:180px; 
  height:auto; 
  object-fit:cover; 
  border-radius:8px; 
  box-shadow:0 5px 15px rgba(0,0,0,0.5); 
  margin-bottom:15px; 
}
.modal-details { width:100%; }
.detail-item { 
  display:flex; 
  justify-content:space-between; 
  margin-bottom:10px; 
  padding-bottom:10px; 
  border-bottom:1px solid #1a2b4a; 
}
.detail-label { font-weight:bold; color:#f1c40f; font-size:0.9rem; }
.detail-value { text-align:right; font-size:0.9rem; }
.modal-right { 
  width:100%; 
  display:flex; 
  flex-direction:column; 
  padding:20px; 
  gap:10px; 
}
.modal-subtitle { 
  font-size:1.1rem; 
  color:#e67e22; 
  margin-bottom:8px; 
  font-weight:normal; 
}
.modal-description-container {  }
.modal-description { line-height:1.6; font-size:1rem; margin-bottom:10px; }
.video-container { 
  margin: 12px 0; 
  border-radius:8px; 
  overflow:hidden; 
  max-height:250px; 
  background:#061120; 
  position: relative;
  aspect-ratio: 16/9;
}
.video-container iframe { 
  width:100%; 
  height:100%; 
  border:none; 
}

/* BOTONES MODAL */
.modal-buttons { 
  display:flex; 
  gap:10px; 
  flex-wrap:wrap; 
  margin-top:10px; 
}
.modal-buttons a {
  display:inline-flex; 
  align-items:center; 
  justify-content:center; 
  gap:6px;
  padding:8px 15px; 
  border-radius:30px; 
  font-weight:bold; 
  text-decoration:none;
  transition: all .25s; 
  color:#fff;
  font-size: 0.9rem;
}
.btn-amazon { background:#ff9900; } .btn-amazon:hover { background:#e68a00; }
.btn-casadelibro { background:#3498db; } .btn-casadelibro:hover { background:#2980b9; }
.btn-directo { background:#27ae60; } .btn-directo:hover { background:#1e8449; }

/* RATING STYLES (medias estrellas con máscara) */
.modal-rating .star {
  font-size: 18px;
  color: #444;
  position: relative;
}
.modal-rating .star.full { color: #f1c40f; }
.modal-rating .star.half::before {
  content: "\f005";
  font-family: "Font Awesome 6 Free";
  font-weight: 900;
  color: #f1c40f;
  position: absolute;
  left: 0;
  width: 50%;
  overflow: hidden;
}

/* RESPONSIVE */
@media (min-width: 768px) {
  .books-grid {
    grid-template-columns: repeat(3, 1fr);
  }
  
  .author-container {
    flex-direction: row;
    align-items: flex-start;
    text-align: left;
  }
  
  .author-info {
    text-align: left;
  }
  
  .author-name:after {
    left: 0;
    transform: none;
  }
  
  .modal-content {
    flex-direction: row;
  }
  
  .modal-left {
    width: 40%;
    border-right: 1px solid #1a2b4a;
    border-bottom: none;
  }
  
  .modal-right {
    width: 60%;
  }
  
  .top-menu {
    padding: 15px 30px;
  }
  
  .logo h1 {
    font-size: 1.8rem;
  }
  
  .menu-icons {
    gap: 20px;
  }
  
  .menu-icon {
    font-size: 1.5rem;
  }
  
  .slider-container {
    height: 400px;
  }
  
  .slide-title {
    font-size: 2rem;
  }
  
  .slide-description {
    font-size: 1.1rem;
  }
}

@media (min-width: 992px) {
  .books-grid {
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    padding: 15px;
  }
  
  .card {
    border-radius: 12px;
  }
  
  .card-overlay {
    padding: 15px;
  }
  
  .card-title {
    font-size: 16px;
  }
  
  .card-author {
    font-size: 14px;
  }
  
  .author-section {
    padding: 60px 40px;
  }
  
  .author-image {
    width: 220px;
    height: 220px;
  }
  
  .author-name {
    font-size: 2.5rem;
  }
}

@media (max-width: 480px) {
  .books-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    padding: 8px;
  }
  
  .card-title {
    font-size: 12px;
  }
  
  .card-author {
    font-size: 10px;
  }
  
  .modal-buttons {
    flex-direction: column;
  }
  
  .modal-buttons a {
    width: 100%;
    text-align: center;
  }
  
  .author-image {
    width: 150px;
    height: 150px;
  }
  
  .author-name {
    font-size: 1.8rem;
  }
  
  .author-bio {
    font-size: 1rem;
  }
  
  .author-details {
    gap: 10px;
  }
  
  .author-detail {
    min-width: 120px;
    padding: 10px;
  }
  
  .detail-value {
    font-size: 1.3rem;
  }
}
</style>
</head>
<body>

<!-- LOADING SCREEN -->
<div class="loading" id="loading">
  <div class="spinner"></div>
  <div class="loading-text">Cargando biblioteca...</div>
</div>

<!-- HEADER + SLIDER -->
<div class="header-container">
  <div class="top-menu">
    <div class="logo"><i class="fas fa-book-reader"></i><h1>Biblioteca Premium</h1></div>
    <div class="menu-icons">
      <div class="menu-icon"><i class="fas fa-home"></i></div>
      <div class="menu-icon"><i class="fas fa-book-open"></i></div>
      <div class="menu-icon"><i class="fas fa-heart"></i></div>
      <div class="menu-icon"><i class="fas fa-search"></i></div>
      <div class="menu-icon"><i class="fas fa-user"></i></div>
    </div>
  </div>

  <div class="slider-container">
    <div class="slide active">
      <!-- Imagen optimizada con menor resolución (placeholder) -->
      <img loading="lazy" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='400' viewBox='0 0 800 400' fill='%231a2b4a'%3E%3Crect width='800' height='400' fill='%231a2b4a'/%3E%3Cpath d='M400,200 L500,150 L600,250 L550,300 L450,250 Z' fill='%230a1a2e'/%3E%3C/svg%3E" data-src="https://images.pexels.com/photos/1370298/pexels-photo-1370298.jpeg" alt="Libro 1" class="lazy-image">
      <div class="slide-overlay">
        <h3 class="slide-title">Descubre Nuevos Mundos</h3>
        <p class="slide-description">Explora nuestra colección de bestsellers y libros exclusivos para todos los gustos.</p>
      </div>
    </div>
    <div class="slide">
      <img loading="lazy" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='400' viewBox='0 0 800 400' fill='%231a2b4a'%3E%3Crect width='800' height='400' fill='%231a2b4a'/%3E%3Ccircle cx='400' cy='200' r='100' fill='%230a1a2e'/%3E%3C/svg%3E" data-src="https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg" alt="Libro 2" class="lazy-image">
      <div class="slide-overlay">
        <h3 class="slide-title">Clásicos Atemporales</h3>
        <p class="slide-description">Revive las obras maestras que han marcado generaciones enteras.</p>
      </div>
    </div>
    <div class="slide">
      <img loading="lazy" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='400' viewBox='0 0 800 400' fill='%231a2b4a'%3E%3Crect width='800' height='400' fill='%231a2b4a'/%3E%3Crect x='300' y='150' width='200' height='100' fill='%230a1a2e'/%3E%3C/svg%3E" data-src="https://images.pexels.com/photos/459791/pexels-photo-459791.jpeg" alt="Libro 3" class="lazy-image">
      <div class="slide-overlay">
        <h3 class="slide-title">Fantasía y Aventura</h3>
        <p class="slide-description">Sumérgete en universos épicos llenos de magia y personajes inolvidables.</p>
      </div>
    </div>

    <div class="slider-nav">
      <div class="slider-dot active" data-slide="0"></div>
      <div class="slider-dot" data-slide="1"></div>
      <div class="slider-dot" data-slide="2"></div>
    </div>
  </div>
</div>

<!-- SECCIÓN AUTOR AITOR -->
<section class="author-section">
  <div class="author-container">
    <img loading="lazy" src="https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Aitor García" class="author-image">
    <div class="author-info">
      <h2 class="author-name">Aitor García</h2>
      <p class="author-bio">
        Aitor García es un reconocido autor contemporáneo especializado en narrativa fantástica y realismo mágico. 
        Con más de 15 años de experiencia en el mundo literario, sus obras han sido traducidas a 12 idiomas y 
        han recibido numerosos premios internacionales. Su estilo único combina elementos de la tradición literaria 
        clásica con innovadoras técnicas narrativas que cautivan a lectores de todas las edades.
      </p>
      <p class="author-bio">
        Además de su labor como escritor, Aitor imparte talleres de escritura creativa y colabora regularmente 
        con diversas revistas literarias. Su pasión por la literatura se manifiesta en cada una de sus obras, 
        donde explora la complejidad del alma humana a través de historias profundas y personajes memorables.
      </p>
      <div class="author-details">
        <div class="author-detail">
          <span class="detail-value">12</span>
          <span class="detail-label">Obras publicadas</span>
        </div>
        <div class="author-detail">
          <span class="detail-value">8</span>
          <span class="detail-label">Premios literarios</span>
        </div>
        <div class="author-detail">
          <span class="detail-value">15+</span>
          <span class="detail-label">Años de experiencia</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- LIBROS AUTOR -->
<div class="genre-row">
  <div class="genre-header">
    <h2><i class="fas fa-book"></i> Libros de Aitor García</h2>
    <a href="#" class="ver-todo">Ver todos <i class="fas fa-chevron-right"></i></a>
  </div>
  <div id="library" class="books-grid"></div>
</div>

<!-- MODAL -->
<div id="bookModal" class="modal" aria-hidden="true">
  <div class="modal-container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-header">
      <h2 class="modal-title" id="modal-title">Título del libro</h2>
      <button class="close" aria-label="Cerrar modal">&times;</button>
    </div>
    <div class="modal-content">
      <div class="modal-left">
        <img id="modal-cover" src="" alt="Portada libro" loading="lazy">
        <div class="modal-details">
          <div class="modal-rating" id="modal-rating"></div>
          <div class="detail-item"><span class="detail-label">Páginas:</span><span class="detail-value" id="modal-pages">320</span></div>
          <div class="detail-item"><span class="detail-label">ISBN:</span><span class="detail-value" id="modal-isbn">123-4567890123</span></div>
          <div class="detail-item"><span class="detail-label">Idioma:</span><span class="detail-value" id="modal-language">Español</span></div>
          <div class="detail-item"><span class="detail-label">Editorial:</span><span class="detail-value" id="modal-publisher">Ejemplo Editorial</span></div>
          <div class="detail-item"><span class="detail-label">Año:</span><span class="detail-value" id="modal-year">2023</span></div>
          <div class="detail-item"><span class="detail-label">Género:</span><span class="detail-value" id="modal-genre">Novela</span></div>
        </div>
      </div>
      <div class="modal-right">
        <h4 class="modal-subtitle" id="modal-subtitle">Subtítulo / Autor</h4>
        <div class="modal-description-container">
          <p class="modal-description" id="modal-description">Descripción completa del libro...</p>
        </div>
        <div class="video-container">
          <iframe id="modal-video" src="" frameborder="0" allowfullscreen loading="lazy"></iframe>
        </div>
        <div class="modal-buttons">
          <a href="#" target="_blank" class="btn-amazon"><i class="fab fa-amazon"></i> Comprar en Amazon</a>
          <a href="#" target="_blank" class="btn-casadelibro"><i class="fas fa-store"></i> Comprar Casa del Libro</a>
          <a href="#" target="_blank" class="btn-directo"><i class="fas fa-shopping-cart"></i> Comprar Directo</a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* =========================
   DATOS DE LIBROS (con imágenes optimizadas)
   ========================= */
const libros = [
  { 
    titulo:"Cien años de soledad", 
    autor:"Gabriel García Márquez", 
    subtitulo:"Obra maestra del realismo mágico", 
    genero:"Realismo Mágico",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='20' fill='%23f1c40f' text-anchor='middle'%3ECien años%3C/text%3E%3C/svg%3E", 
    descripcion:"Novela sobre la familia Buendía en el pueblo ficticio de Macondo. Considerada una obra maestra de la literatura hispanoamericana y universal.", 
    paginas:471, 
    isbn:"978-8439721102", 
    idioma:"Español", 
    editorial:"Sudamericana", 
    año:1967, 
    rating:4.8, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"1984", 
    autor:"George Orwell", 
    subtitulo:"Distopía", 
    genero:"Distopía",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='30' fill='%23f1c40f' text-anchor='middle'%3E1984%3C/text%3E%3C/svg%3E", 
    descripcion:"Winston Smith vive en un estado totalitario bajo el control del Gran Hermano. Una visión aterradora de un futuro controlado por la vigilancia constante.", 
    paginas:328, 
    isbn:"978-0451524935", 
    idioma:"Español", 
    editorial:"Debolsillo", 
    año:1949, 
    rating:4.7, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"El Señor de los Anillos", 
    autor:"J.R.R. Tolkien", 
    subtitulo:"La comunidad del anillo", 
    genero:"Fantasía Épica",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='15' fill='%23f1c40f' text-anchor='middle'%3ESeñor de los Anillos%3C/text%3E%3C/svg%3E", 
    descripcion:"Frodo Bolsón y la misión de destruir el Anillo Único en el Monte del Destino. Una épica aventura en la Tierra Media.", 
    paginas:576, 
    isbn:"978-8445000660", 
    idioma:"Español", 
    editorial:"Minotauro", 
    año:1954, 
    rating:4.9, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"Don Quijote de la Mancha", 
    autor:"Miguel de Cervantes", 
    subtitulo:"El ingenioso hidalgo", 
    genero:"Novela Clásica",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='15' fill='%23f1c40f' text-anchor='middle'%3EDon Quijote%3C/text%3E%3C/svg%3E", 
    descripcion:"Las aventuras de Don Quijote y Sancho Panza. Considerada la primera novela moderna y una de las mejores obras de la literatura universal.", 
    paginas:863, 
    isbn:"978-8424113968", 
    idioma:"Español", 
    editorial:"Editorial EDAF", 
    año:1605, 
    rating:4.8, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"Rayuela", 
    autor:"Julio Cortázar", 
    subtitulo:"Una novela contranovela", 
    genero:"Novela Experimental",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='20' fill='%23f1c40f' text-anchor='middle'%3ERayuela%3C/text%3E%3C/svg%3E", 
    descripcion:"La historia de Horacio Oliveira en París y Buenos Aires. Una obra innovadora que puede leerse de múltiples maneras.", 
    paginas:736, 
    isbn:"978-8432216429", 
    idioma:"Español", 
    editorial:"Alfaguara", 
    año:1963, 
    rating:4.6, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"Ficciones", 
    autor:"Jorge Luis Borges", 
    subtitulo:"Colección de cuentos", 
    genero:"Ficción",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='20' fill='%23f1c40f' text-anchor='middle'%3EFicciones%3C/text%3E%3C/svg%3E", 
    descripcion:"Relatos que exploran laberintos, espejos y realidades alternativas. Una de las obras cumbres de la literatura del siglo XX.", 
    paginas:237, 
    isbn:"978-8426413767", 
    idioma:"Español", 
    editorial:"Editorial Debolsillo", 
    año:1944, 
    rating:4.9, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"La Sombra del Viento", 
    autor:"Carlos Ruiz Zafón", 
    subtitulo:"El cementerio de los libros olvidados", 
    genero:"Misterio",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='15' fill='%23f1c40f' text-anchor='middle'%3ESombra del Viento%3C/text%3E%3C/svg%3E", 
    descripcion:"Daniel Sempere descubre un libro maldito en el Barcelona de posguerra. Una novela de misterio y amor por los libros.", 
    paginas:565, 
    isbn:"978-8408092311", 
    idioma:"Español", 
    editorial:"Planeta", 
    año:2001, 
    rating:4.7, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  { 
    titulo:"Crimen y Castigo", 
    autor:"Fiódor Dostoyevski", 
    subtitulo:"Novela psicológica", 
    genero:"Clásico Ruso",
    portada:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='300' viewBox='0 0 200 300' fill='%231a2b4a'%3E%3Crect width='200' height='300' fill='%231a2b4a'/%3E%3Ctext x='100' y='150' font-family='Arial' font-size='15' fill='%23f1c40f' text-anchor='middle'%3ECrimen y Castigo%3C/text%3E%3C/svg%3E", 
    descripcion:"Raskólnikov comete un crimen y sufre las consecuencias morales. Un profundo análisis de la psicología humana.", 
    paginas:527, 
    isbn:"978-8420665154", 
    idioma:"Español", 
    editorial:"Alianza Editorial", 
    año:1866, 
    rating:4.8, 
    video:"https://www.youtube.com/embed/CTdm5tTu6pE"
  }
];

// URLs de imágenes reales para carga diferida
const realImages = [
  "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg",
  "https://images.pexels.com/photos/1370298/pexels-photo-1370298.jpeg",
  "https://images.pexels.com/photos/459791/pexels-photo-459791.jpeg",
  "https://images.pexels.com/photos/1166657/pexels-photo-1166657.jpeg",
  "https://images.pexels.com/photos/1370295/pexels-photo-1370295.jpeg",
  "https://images.pexels.com/photos/1370296/pexels-photo-1370296.jpeg",
  "https://images.pexels.com/photos/1370297/pexels-photo-1370297.jpeg",
  "https://images.pexels.com/photos/1166658/pexels-photo-1166658.jpeg"
];

/* =========================
   RENDERIZADO DE LIBROS
   ========================= */
const libraryContainer = document.getElementById('library');
function renderLibrary() {
  libraryContainer.innerHTML = '';
  libros.forEach((libro, index) => {
    const card = document.createElement('a'); 
    card.href="#"; 
    card.className="card";
    card.innerHTML=`
      <img loading="lazy" src="${libro.portada}" data-src="${realImages[index % realImages.length]}" alt="${libro.titulo}" class="lazy-image">
      <div class="card-overlay">
        <div class="card-title">${libro.titulo}</div>
        <div class="card-author">${libro.autor}</div>
      </div>
    `;
    card.addEventListener('click', e => {
      e.preventDefault(); 
      openBookModal(libro);
    });
    libraryContainer.appendChild(card);
  });
  
  // Iniciar carga diferida de imágenes
  lazyLoadImages();
}

/* =========================
   CARGA DIFERIDA DE IMÁGENES (MEJORADA)
   ========================= */
function lazyLoadImages() {
  const lazyImages = document.querySelectorAll('.lazy-image');
  
  if ('IntersectionObserver' in window) {
    const imageObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          // Cambios: limpiar espacios en URL y asignar data-src si existe
          if (img.dataset.src) {
            img.src = img.dataset.src.trim();
          }
          img.removeAttribute('data-src');
          img.classList.remove('lazy-image');
          imageObserver.unobserve(img);
        }
      });
    }, { rootMargin: '200px 0px', threshold: 0.01 }); // carga anticipada antes de entrar en viewport

    lazyImages.forEach(img => {
      imageObserver.observe(img);
    });
  } else {
    // Fallback para navegadores que no soportan IntersectionObserver
    lazyImages.forEach(img => {
      if (img.dataset.src) img.src = img.dataset.src.trim();
      img.classList.remove('lazy-image');
    });
  }
}

/* =========================
   MODAL
   ========================= */
const modal = document.getElementById('bookModal');
const modalCover = document.getElementById('modal-cover');
const modalTitle = document.getElementById('modal-title');
const modalSubtitle = document.getElementById('modal-subtitle');
const modalDescription = document.getElementById('modal-description');
const modalPages = document.getElementById('modal-pages');
const modalISBN = document.getElementById('modal-isbn');
const modalLanguage = document.getElementById('modal-language');
const modalPublisher = document.getElementById('modal-publisher');
const modalYear = document.getElementById('modal-year');
const modalGenre = document.getElementById('modal-genre');
const modalRating = document.getElementById('modal-rating');
const modalVideo = document.getElementById('modal-video');

function renderRatingStars(rating) {
  // Genera 5 elementos de estrella; aplica clase full/half/empty
  const container = document.createElement('div');
  container.className = 'modal-rating';
  const full = Math.floor(rating);
  const remainder = rating - full;
  for (let i = 0; i < 5; i++) {
    const iElem = document.createElement('i');
    // usar font awesome classes, mantener accesibilidad
    if (i < full) {
      iElem.className = 'fa-solid fa-star star full';
    } else if (i === full && remainder >= 0.25 && remainder < 0.75) {
      // aproximación a media estrella
      iElem.className = 'fa-regular fa-star star half';
    } else if (i === full && remainder >= 0.75) {
      // casi full -> mostrar full
      iElem.className = 'fa-solid fa-star star full';
    } else {
      iElem.className = 'fa-regular fa-star star';
    }
    container.appendChild(iElem);
  }
  return container;
}

function openBookModal(libro) {
  // Cargar imagen real para el modal
  const bookIndex = libros.findIndex(l => l.titulo === libro.titulo);
  modalCover.src = realImages[bookIndex % realImages.length];
  
  modalTitle.textContent = libro.titulo;
  modalSubtitle.textContent = libro.subtitulo + " / " + libro.autor;
  modalDescription.textContent = libro.descripcion;
  modalPages.textContent = libro.paginas;
  modalISBN.textContent = libro.isbn;
  modalLanguage.textContent = libro.idioma;
  modalPublisher.textContent = libro.editorial;
  modalYear.textContent = libro.año;
  modalGenre.textContent = libro.genero;
  
  // Rating con medias estrellas
  modalRating.innerHTML = '';
  modalRating.appendChild(renderRatingStars(libro.rating));
  
  // Video
  modalVideo.src = libro.video.trim();
  modal.classList.add('show');
  
  // Pausar video cuando se cierra el modal
  const iframe = modalVideo;
  const videoSrc = iframe.src;
  // remove previous close listeners by cloning button to avoid duplicates
  const closeBtn = modal.querySelector('.close');
  const newCloseBtn = closeBtn.cloneNode(true);
  closeBtn.parentNode.replaceChild(newCloseBtn, closeBtn);
  newCloseBtn.addEventListener('click', () => {
    modal.classList.remove('show');
    iframe.src = "";
    setTimeout(() => {
      iframe.src = videoSrc;
    }, 300);
  });
}

// Cerrar modal al hacer clic fuera del contenido
modal.addEventListener('click', (e) => {
  if (e.target === modal) {
    modal.classList.remove('show');
    modalVideo.src = "";
  }
});

/* =========================
   SLIDER
   ========================= */
const slides = document.querySelectorAll('.slide');
const dots = document.querySelectorAll('.slider-dot');
let currentSlide = 0;
let slideInterval;

function showSlide(n) {
  slides.forEach((s, i) => {
    s.classList.toggle('active', i === n);
    dots[i].classList.toggle('active', i === n);
  });
  
  // Cargar imagen real para la diapositiva activa (si no se ha cargado)
  const activeSlideImg = slides[n].querySelector('.lazy-image');
  if (activeSlideImg && activeSlideImg.classList.contains('lazy-image')) {
    if (activeSlideImg.dataset.src) {
      activeSlideImg.src = activeSlideImg.dataset.src.trim();
      activeSlideImg.removeAttribute('data-src');
    }
    activeSlideImg.classList.remove('lazy-image');
  }
}

function startSlider() {
  slideInterval = setInterval(() => {
    currentSlide = (currentSlide + 1) % slides.length;
    showSlide(currentSlide);
  }, 5000);
}

dots.forEach(dot => {
  dot.addEventListener('click', () => {
    clearInterval(slideInterval);
    currentSlide = parseInt(dot.dataset.slide);
    showSlide(currentSlide);
    startSlider();
  });
});

/* =========================
   PRELOADER Y CARGA INICIAL
   ========================= */
window.addEventListener('load', function() {
  const loading = document.getElementById('loading');
  
  // Renderizar contenidos y comenzar lazy loading
  renderLibrary();
  startSlider();
  
  // Precargar imágenes para mejor experiencia (en background)
  realImages.forEach(src => {
    const img = new Image();
    img.src = src.trim();
  });

  // Ocultar preloader cuando el browser haya pintado y se haya iniciado el lazy-load
  // (no esperamos a descargar todas las imágenes grandes)
  requestAnimationFrame(() => {
    setTimeout(() => {
      loading.classList.add('hidden');
    }, 250); // pequeño retraso para suavizar la transición
  });
});

// Iniciar el renderizado si la página ya está cargada
if (document.readyState === 'complete') {
  document.getElementById('loading').classList.add('hidden');
  renderLibrary();
  startSlider();
}
</script>
</body>
</html>
