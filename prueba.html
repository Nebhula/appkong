<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Biblioteca Literaria - Slider Mejorado</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* === RESET / BASE === */
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body {
  background: linear-gradient(135deg, #0a1a2e 0%, #061120 100%);
  color: #fff;
  min-height: 100vh;
  overflow-x: hidden;
  padding-bottom: 40px;
}

/* === HEADER / SLIDER === */
.header-container { position: relative; margin-bottom: 40px; }
.top-menu {
  display:flex; justify-content:space-between; align-items:center;
  padding:15px 30px;
  background: linear-gradient(to right, #0a1a2e 0%, #061120 100%);
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
}
.logo { display:flex; align-items:center; gap:10px; }
.logo h1 { color:#f1c40f; font-size:1.8rem; text-shadow:2px 2px 4px rgba(0,0,0,0.5); }
.menu-icons { display:flex; gap:20px; }
.menu-icon { color:#f1c40f; font-size:1.5rem; cursor:pointer; transition: transform .3s, color .3s; }
.menu-icon:hover { color:#fff; transform: translateY(-3px); }

.slider-container { position:relative; width:100%; height:400px; overflow:hidden; }
.slide { position:absolute; width:100%; height:100%; opacity:0; transition:opacity 1.2s ease-in-out; z-index:1; }
.slide.active { opacity:1; z-index:2; }
.slide img { width:100%; height:100%; object-fit:cover; display:block; }
.slide-overlay {
  position:absolute; bottom:0; left:0; right:0;
  background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
  padding:30px; color:#fff;
}
.slide-title { font-size:2rem; color:#f1c40f; margin-bottom:10px; }
.slide-description { font-size:1.1rem; max-width:600px; }

.slider-nav { position:absolute; bottom:20px; left:50%; transform:translateX(-50%); display:flex; gap:10px; z-index:3; }
.slider-dot { width:12px; height:12px; border-radius:50%; background:rgba(255,255,255,0.5); cursor:pointer; transition: transform .2s, background .2s; }
.slider-dot.active { background:#f1c40f; transform:scale(1.2); }

/* === LIBROS / CARDS === */
.genre-row { margin-bottom:50px; padding:0 20px; }
.genre-header {
  display:flex; justify-content:space-between; align-items:center;
  margin:0 10px 20px 10px; padding-bottom:10px; border-bottom:2px solid #f1c40f;
}
.genre-header h2 { font-size:1.8rem; color:#f1c40f; display:flex; align-items:center; gap:10px; }
.ver-todo { color:#f1c40f; font-weight:bold; text-decoration:none; display:flex; align-items:center; gap:5px; transition:transform .3s; }
.ver-todo:hover { transform: translateX(5px); text-decoration:underline; }

.books-row {
  display:flex; overflow-x:auto; overflow-y:hidden; gap:20px; padding:15px; scroll-behavior:smooth;
}
.books-row::-webkit-scrollbar { height:8px; }
.books-row::-webkit-scrollbar-thumb { background:#f1c40f; border-radius:4px; }
.books-row::-webkit-scrollbar-track { background: rgba(255,255,255,0.08); border-radius:4px; }

.card {
  flex:0 0 auto; width:200px; height:320px; border-radius:12px; overflow:hidden; position:relative;
  cursor:pointer; transition: all .3s ease; display:block; text-decoration:none; color:inherit;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
.card img { width:100%; height:100%; object-fit:cover; display:block; transition: transform .5s; }
.card-overlay {
  position:absolute; bottom:0; left:0; right:0;
  background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
  padding:20px 15px 15px; z-index:2; transform: translateY(100%); transition: transform .3s ease;
}
.card-title { font-size:16px; font-weight:bold; margin-bottom:5px; color:#f1c40f; }
.card-author { font-size:14px; opacity:0.9; }
.card:hover { transform: translateY(-10px) scale(1.03); box-shadow: 0 12px 25px rgba(0,0,0,0.5); }
.card:hover img { transform: scale(1.1); }
.card:hover .card-overlay { transform: translateY(0); }

/* === MODAL: COMPORTAMIENTO SOLICITADO ===
   - El overlay (.modal) cubre la pantalla y SI EL CONTENIDO ES MÁS ALTO, se desplaza TODO en conjunto.
   - La columna izquierda NO TENDRÁ SU PROPIO SCROLL.
   - Scrollbars ocultos visualmente.
*/
.modal {
  display:none;
  position:fixed;
  inset:0; /* top:0; left:0; right:0; bottom:0; */
  z-index:1000;
  background-color: rgba(0,0,0,0.95); /* <--- aquí está el fondo oscuro */
  overflow-y: auto;                    /* ✔️ permite desplazar TODO en conjunto */
  -webkit-overflow-scrolling: touch;    /* suaviza en iOS */
  -ms-overflow-style: none;            /* IE/Edge - ocultar barra */
  scrollbar-width: none;               /* Firefox - ocultar barra */
  padding: 20px;                       /* espacio al top/bottom para cuando se centra */
}

/* ocultar scrollbar webkit */
.modal::-webkit-scrollbar { display: none; }

.modal.show { display:block; /* no centrar verticalmente: permitimos scroll natural */ }

.modal-container {
  width: 100%;
  max-width: 1200px;   /* ancho máximo para que quede bien en pantallas grandes */
  margin: 0 auto;
  background: #0a1a2e;
  color: #fff;
  border-radius: 8px;
  overflow: visible;
  display:flex;
  flex-direction:column;
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
}

/* header de la modal */
.modal-header {
  padding: 20px 30px;
  background: #061120;
  display:flex; justify-content:space-between; align-items:center;
  border-bottom:1px solid #1a2b4a;
  flex-shrink:0;
}
.modal-title { font-size:1.8rem; color:#f1c40f; max-width:80%; word-wrap:break-word; }
.close {
  font-size:30px; color:#f1c40f; font-weight:bold; cursor:pointer;
  background:none; border:none; transition: transform .25s;
}
.close:hover { transform: rotate(90deg); }

/* cuerpo: dos columnas en PC, apilado en móvil */
.modal-content {
  display:flex;
  flex-direction:row;
  align-items:flex-start;
  gap:0;
}

/* izquierda: imagen + detalles -> sin scroll propio (se mueve con la modal) */
.modal-left {
  flex: 0 0 320px;
  padding: 25px;
  display:flex;
  flex-direction:column;
  align-items:center;
  background:#061120;
  border-right:1px solid #1a2b4a;
  overflow: visible; /* important: NO scroll propio */
}
.modal-left img {
  width:100%; max-width:200px; height:auto; object-fit:cover; border-radius:8px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.5); margin-bottom:20px;
}
.modal-details { width:100%; }
.detail-item { display:flex; justify-content:space-between; margin-bottom:12px; padding-bottom:12px; border-bottom:1px solid #1a2b4a; }
.detail-label { font-weight:bold; color:#f1c40f; font-size:0.95rem; }
.detail-value { text-align:right; font-size:0.95rem; }

/* derecha: contenido principal - se expande y aumenta la altura total de la modal */
.modal-right {
  flex:1;
  display:flex;
  flex-direction:column;
  padding:25px;
  gap:12px;
  overflow: visible; /* no scroll independiente: todo se mueve en conjunto */
}

.modal-subtitle { font-size:1.2rem; color:#e67e22; margin-bottom:10px; font-weight:normal; }
.modal-description-container { overflow: visible; }
.modal-description { line-height:1.6; font-size:1.05rem; margin-bottom:10px; }

.video-container { margin: 15px 0; border-radius:8px; overflow:hidden; max-height:320px; background:#061120; }
.video-container iframe { width:100%; height:100%; min-height:200px; border:none; }

/* botones en modal */
.modal-buttons { display:flex; gap:12px; flex-wrap:wrap; margin-top:10px; }
.modal-buttons a {
  display:inline-flex; align-items:center; gap:8px; padding:10px 18px; background:#f1c40f; color:#2c3e50;
  text-decoration:none; border-radius:30px; font-weight:bold; transition: all .25s;
}
.modal-buttons a:hover { background:#f39c12; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

/* ocultar scrollbar para elementos que puedan usarlo - por seguridad */
.modal-right::-webkit-scrollbar, .modal-container::-webkit-scrollbar { display:none; }
.modal-right { -ms-overflow-style: none; scrollbar-width: none; }

/* RESPONSIVE: en móviles apilar y permitir scroll general */
@media (max-width: 1199px) {
  .modal-container { border-radius: 0; max-width:100%; margin:0 0; }
  .modal-left { flex: unset; width:100%; border-right:none; border-bottom:1px solid #1a2b4a; padding:20px; text-align:center; }
  .modal-content { flex-direction:column; }
  .modal-right { padding:20px; }
  .modal-title { font-size:1.4rem; }
  .video-container iframe { min-height:180px; }
  /* centrar carousel móvil */
  .books-row { padding-left: 10px !important; padding-right: 10px !important; margin-left: -7px !important; margin-right: -10px !important; }
}

/* pequeños ajustes */
.genre-icon { font-size:24px; }
.loading { display:flex; justify-content:center; align-items:center; height:100px; }
.loading::after { content:""; width:40px; height:40px; border:4px solid transparent; border-top:4px solid #f1c40f; border-radius:50%; animation: spin 1s linear infinite; }
@keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
</style>
</head>
<body>

<!-- HEADER + SLIDER -->
<div class="header-container">
  <div class="top-menu">
    <div class="logo"><i class="fas fa-book-reader"></i><h1>Biblioteca Premium</h1></div>
    <div class="menu-icons">
      <div class="menu-icon"><i class="fas fa-home"></i></div>
      <div class="menu-icon"><i class="fas fa-book-open"></i></div>
      <div class="menu-icon"><i class="fas fa-heart"></i></div>
      <div class="menu-icon"><i class="fas fa-search"></i></div>
      <div class="menu-icon"><i class="fas fa-user"></i></div>
    </div>
  </div>

  <div class="slider-container">
    <div class="slide active">
      <img src="https://images.pexels.com/photos/1370298/pexels-photo-1370298.jpeg" alt="Libro 1">
      <div class="slide-overlay">
        <h3 class="slide-title">Descubre Nuevos Mundos</h3>
        <p class="slide-description">Explora nuestra colección de bestsellers y libros exclusivos para todos los gustos.</p>
      </div>
    </div>

    <div class="slide">
      <img src="https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg" alt="Libro 2">
      <div class="slide-overlay">
        <h3 class="slide-title">Clásicos Atemporales</h3>
        <p class="slide-description">Revive las obras maestras que han marcado generaciones enteras.</p>
      </div>
    </div>

    <div class="slide">
      <img src="https://images.pexels.com/photos/459791/pexels-photo-459791.jpeg" alt="Libro 3">
      <div class="slide-overlay">
        <h3 class="slide-title">Fantasía y Aventura</h3>
        <p class="slide-description">Sumérgete en universos épicos llenos de magia y personajes inolvidables.</p>
      </div>
    </div>

    <div class="slider-nav">
      <div class="slider-dot active" data-slide="0"></div>
      <div class="slider-dot" data-slide="1"></div>
      <div class="slider-dot" data-slide="2"></div>
    </div>
  </div>
</div>

<!-- Biblioteca (carruseles por género) -->
<div id="library"></div>

<!-- MODAL -->
<div id="bookModal" class="modal" aria-hidden="true">
  <div class="modal-container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-header">
      <h2 class="modal-title" id="modal-title">Título del libro</h2>
      <button class="close" aria-label="Cerrar modal">&times;</button>
    </div>

    <div class="modal-content">
      <div class="modal-left">
        <img id="modal-cover" src="" alt="Portada libro">
        <div class="modal-details">
          <div class="modal-rating" id="modal-rating"></div>

          <div class="detail-item"><span class="detail-label">Páginas:</span><span class="detail-value" id="modal-pages">320</span></div>
          <div class="detail-item"><span class="detail-label">ISBN:</span><span class="detail-value" id="modal-isbn">123-4567890123</span></div>
          <div class="detail-item"><span class="detail-label">Idioma:</span><span class="detail-value" id="modal-language">Español</span></div>
          <div class="detail-item"><span class="detail-label">Editorial:</span><span class="detail-value" id="modal-publisher">Ejemplo Editorial</span></div>
          <div class="detail-item"><span class="detail-label">Año:</span><span class="detail-value" id="modal-year">2023</span></div>
          <div class="detail-item"><span class="detail-label">Género:</span><span class="detail-value" id="modal-genre">Novela</span></div>
        </div>
      </div>

      <div class="modal-right">
        <h4 class="modal-subtitle" id="modal-subtitle">Subtítulo / Autor</h4>
        <div class="modal-description-container">
          <p class="modal-description" id="modal-description">Descripción completa del libro...</p>
        </div>

        <div class="video-container">
          <iframe id="modal-video" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>

        <div class="modal-buttons">
          <a href="#" target="_blank"><i class="fas fa-shopping-cart"></i> Comprar</a>
          <a href="#" target="_blank"><i class="fab fa-amazon"></i> Amazon</a>
          <a href="#" target="_blank"><i class="fas fa-share-alt"></i> Compartir</a>
          <a href="#" target="_blank"><i class="fas fa-book-open"></i> Leer muestra</a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// =========================
// Datos de libros (originales + clones)
// =========================
const libros = [
  {
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },

{
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },


{
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },


{
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },


{
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },

{
    titulo: "Cien años de soledad",
    autor: "Gabriel García Márquez",
    subtitulo: "Una obra maestra del realismo mágico",
    genero: "Realismo Mágico",
    portada: "https://images.pexels.com/photos/1926988/pexels-photo-1926988.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela narra la historia de la familia Buendía a lo largo de siete generaciones en el pueblo ficticio de Macondo. José Arcadio Buendía y Úrsula Iguarán se casan y se van de su pueblo para fundar Macondo. La obra es considerada una de las más representativas del realismo mágico y de la literatura hispanoamericana.",
    paginas: 471,
    isbn: "978-8439721102",
    idioma: "Español",
    editorial: "Sudamericana",
    año: 1967,
    rating: 4.8,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },

  
  {
    titulo: "1984",
    autor: "George Orwell",
    subtitulo: "Una visión distópica del futuro",
    genero: "Distopía",
    portada: "https://images.pexels.com/photos/1370298/pexels-photo-1370298.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "La novela introduce el concepto del 'Gran Hermano', un líder omnipresente que vigila a todos los ciudadanos. Winston Smith, el protagonista, trabaja reescribiendo la historia para adaptarla a la versión del Partido.",
    paginas: 328,
    isbn: "978-0451524935",
    idioma: "Español",
    editorial: "Debolsillo",
    año: 1949,
    rating: 4.7,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  },
  {
    titulo: "El Señor de los Anillos",
    autor: "J.R.R. Tolkien",
    subtitulo: "La comunidad del anillo",
    genero: "Fantasía Épica",
    portada: "https://images.pexels.com/photos/459791/pexels-photo-459791.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
    descripcion: "En la Tierra Media, el Señor Oscuro Sauron forjó los Grandes Anillos del Poder. Esta épica historia de amistad, coraje y sacrificio sigue la misión de Frodo Bolsón para destruir el Anillo Único.",
    paginas: 576,
    isbn: "978-8445000660",
    idioma: "Español",
    editorial: "Minotauro",
    año: 1954,
    rating: 4.9,
    video: "https://www.youtube.com/embed/CTdm5tTu6pE"
  }
];

// Categorías e iconos
const categorias = ["Realismo Mágico", "Distopía", "Fantasía Épica"];
const iconosCategorias = {
  "Realismo Mágico": "fas fa-magic",
  "Distopía": "fas fa-city",
  "Fantasía Épica": "fas fa-dragon"
};

// Añadir libros adicionales (clones seguros usando la misma portada base para evitar enlaces rotos)
categorias.forEach(cat => {
  // Buscar un libro base de ese género
  const base = libros.find(l => l.genero === cat);
  if (!base) return;
  for (let i = 2; i <= 5; i++) {
    libros.push({
      ...base,
      titulo: `${base.genero} Libro ${i}`,
      autor: `Autor ${i} ${base.autor.split(' ')[0]}`,
      subtitulo: base.subtitulo,
      portada: base.portada,           // usar la misma portada base (segura)
      paginas: base.paginas,
      isbn: base.isbn,
      idioma: base.idioma,
      editorial: base.editorial,
      año: base.año + i,
      rating: Math.min(5, +(base.rating - 0.1 * i + Math.random() * 0.3).toFixed(1))
    });
  }
});

// =========================
// RENDERIZADO DE LA BIBLIOTECA
// =========================
const libraryContainer = document.getElementById('library');

function renderLibrary() {
  libraryContainer.innerHTML = '';

  // Agrupar por género
  const librosPorGenero = {};
  libros.forEach(lib => {
    if (!librosPorGenero[lib.genero]) librosPorGenero[lib.genero] = [];
    librosPorGenero[lib.genero].push(lib);
  });

  Object.keys(librosPorGenero).forEach(cat => {
    const rowDiv = document.createElement('div');
    rowDiv.className = 'genre-row';

    const headerDiv = document.createElement('div');
    headerDiv.className = 'genre-header';

    const title = document.createElement('h2');
    title.innerHTML = `<i class="${iconosCategorias[cat] || 'fas fa-book'} genre-icon"></i> ${cat}`;

    const verTodo = document.createElement('a');
    verTodo.href = "#";
    verTodo.className = "ver-todo";
    verTodo.innerHTML = "Ver todo <i class='fas fa-arrow-right'></i>";

    headerDiv.appendChild(title);
    headerDiv.appendChild(verTodo);
    rowDiv.appendChild(headerDiv);

    const booksRow = document.createElement('div');
    booksRow.className = 'books-row';

    librosPorGenero[cat].forEach(libro => {
      const cardLink = document.createElement('a');
      cardLink.href = "#";
      cardLink.className = "card";
      cardLink.innerHTML = `
        <img src="${libro.portada}" alt="${libro.titulo}">
        <div class="card-overlay">
          <div class="card-title">${libro.titulo}</div>
          <div class="card-author">${libro.autor}</div>
        </div>
      `;
      cardLink.addEventListener('click', (e) => { e.preventDefault(); openBookModal(libro); });
      booksRow.appendChild(cardLink);
    });

    rowDiv.appendChild(booksRow);
    libraryContainer.appendChild(rowDiv);
  });
}

// =========================
// MODAL
// =========================
const modal = document.getElementById('bookModal');
const modalCover = document.getElementById('modal-cover');
const modalTitle = document.getElementById('modal-title');
const modalSubtitle = document.getElementById('modal-subtitle');
const modalDescription = document.getElementById('modal-description');
const modalPages = document.getElementById('modal-pages');
const modalIsbn = document.getElementById('modal-isbn');
const modalLanguage = document.getElementById('modal-language');
const modalPublisher = document.getElementById('modal-publisher');
const modalYear = document.getElementById('modal-year');
const modalGenre = document.getElementById('modal-genre');
const modalVideo = document.getElementById('modal-video');
const modalRating = document.getElementById('modal-rating');
const closeModalBtn = document.querySelector('.close');

function openBookModal(libro) {
  // Rellenar datos
  modalCover.src = libro.portada;
  modalTitle.innerText = libro.titulo;
  modalSubtitle.innerText = `${libro.subtitulo} - ${libro.autor}`;
  modalDescription.innerText = libro.descripcion;
  modalPages.innerText = libro.paginas;
  modalIsbn.innerText = libro.isbn;
  modalLanguage.innerText = libro.idioma;
  modalPublisher.innerText = libro.editorial;
  modalYear.innerText = libro.año;
  modalGenre.innerText = libro.genero;
  modalVideo.src = libro.video;

  // rating (estrellas)
  modalRating.innerHTML = '';
  const fullStars = Math.floor(libro.rating);
  const hasHalf = (libro.rating - fullStars) >= 0.5;
  for (let i = 0; i < fullStars; i++) modalRating.innerHTML += '<i class="fas fa-star"></i>';
  if (hasHalf) modalRating.innerHTML += '<i class="fas fa-star-half-alt"></i>';
  const empty = 5 - fullStars - (hasHalf ? 1 : 0);
  for (let i = 0; i < empty; i++) modalRating.innerHTML += '<i class="far fa-star"></i>';
  modalRating.innerHTML += `<span style="margin-left:10px;">${libro.rating.toFixed(1)}/5</span>`;

  // Mostrar modal y bloquear scroll body para evitar doble scroll de fondo
  modal.classList.add('show');
  modal.setAttribute('aria-hidden', 'false');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  modal.classList.remove('show');
  modal.setAttribute('aria-hidden', 'true');
  modalVideo.src = ''; // parar vídeo
  document.body.style.overflow = ''; // restaurar scroll del body
}

closeModalBtn.addEventListener('click', closeModal);

// cerrar al hacer click fuera del contenedor
window.addEventListener('click', (e) => {
  if (e.target === modal) closeModal();
});

// cerrar con ESC
window.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && modal.classList.contains('show')) closeModal();
});

// =========================
// SLIDER
// =========================
let currentSlide = 0;
const slides = document.querySelectorAll('.slide');
const dots = document.querySelectorAll('.slider-dot');

function goToSlide(index) {
  slides.forEach(s => s.classList.remove('active'));
  dots.forEach(d => d.classList.remove('active'));
  currentSlide = (index + slides.length) % slides.length;
  slides[currentSlide].classList.add('active');
  dots[currentSlide].classList.add('active');
}

// dots click
dots.forEach(dot => dot.addEventListener('click', () => goToSlide(parseInt(dot.dataset.slide, 10))));

// autoplay
setInterval(() => {
  goToSlide(currentSlide + 1);
}, 5000);

// =========================
// INIT
// =========================
renderLibrary();
goToSlide(0);
</script>
</body>
</html>
